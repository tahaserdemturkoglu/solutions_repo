<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 3 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 3";
        var mkdocs_page_input_path = "1 Physics/2 Gravity/Problem_3.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">2 Gravity</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 3</a>
<ul class="current">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Electromagnetism</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../4%20Electromagnetism/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">2 Gravity</li>
<li class="breadcrumb-item active">Problem 3</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="problem-3">Problem 3</h1>
<h1 id="theoretical-analysis">Theoretical Analysis</h1>
<p>In this section, we derive the equations of motion for orbital mechanics, focusing on Newton’s Law of Gravitation, Kepler’s Laws, and the impact of initial conditions on the trajectory of a spacecraft.</p>
<h2 id="1-deriving-equations-of-motion-using-newtons-law-of-gravitation">1. Deriving Equations of Motion Using Newton’s Law of Gravitation</h2>
<p>Newton’s Law of Gravitation gives the force between two masses, which is essential for understanding the motion of objects in space.</p>
<p>The gravitational force <span class="arithmatex">\( F \)</span> between two bodies is given by:</p>
<div class="arithmatex">\[ F = G \frac{m_1 m_2}{r^2} \]</div>
<p>Where:
- <span class="arithmatex">\( F \)</span> is the gravitational force,
- <span class="arithmatex">\( G \)</span> is the gravitational constant (<span class="arithmatex">\(6.67430 \times 10^{-11} \, \text{m}^3 \, \text{kg}^{-1} \, \text{s}^{-2}\)</span>),
- <span class="arithmatex">\( m_1 \)</span> and <span class="arithmatex">\( m_2 \)</span> are the masses of the two bodies,
- <span class="arithmatex">\( r \)</span> is the distance between their centers.</p>
<p>From Newton’s second law of motion, the force is also equal to mass times acceleration, i.e.,</p>
<div class="arithmatex">\[ F = m a \]</div>
<p>Equating the two expressions for <span class="arithmatex">\( F \)</span>, we get the equation of motion:</p>
<div class="arithmatex">\[ m a = G \frac{m_1 m_2}{r^2} \]</div>
<p>For a mass <span class="arithmatex">\( m \)</span> orbiting a central body, we can simplify this to:</p>
<div class="arithmatex">\[ a = G \frac{m_1}{r^2} \]</div>
<p>This gives us the acceleration experienced by the orbiting body due to gravitational attraction.</p>
<h2 id="2-applying-keplers-laws-to-classify-trajectories">2. Applying Kepler’s Laws to Classify Trajectories</h2>
<p>Kepler's Laws describe the motion of planets and other celestial bodies under the influence of gravity.</p>
<h3 id="keplers-first-law-the-law-of-ellipses">Kepler’s First Law: The Law of Ellipses</h3>
<p>The orbit of a planet (or other object) around a central body is an ellipse, with the central body at one focus.</p>
<p>The equation for an ellipse in polar coordinates is:</p>
<div class="arithmatex">\[ r(\theta) = \frac{a(1 - e^2)}{1 + e \cos \theta} \]</div>
<p>Where:
- <span class="arithmatex">\( r(\theta) \)</span> is the radial distance as a function of the true anomaly <span class="arithmatex">\( \theta \)</span>,
- <span class="arithmatex">\( a \)</span> is the semi-major axis,
- <span class="arithmatex">\( e \)</span> is the eccentricity of the ellipse.</p>
<h3 id="keplers-second-law-the-law-of-equal-areas">Kepler’s Second Law: The Law of Equal Areas</h3>
<p>A line segment joining a planet and the central body sweeps out equal areas during equal intervals of time. This implies that the object moves faster when closer to the central body and slower when farther away.</p>
<p>This can be expressed as:</p>
<div class="arithmatex">\[ \frac{dA}{dt} = \frac{1}{2} r^2 \frac{d\theta}{dt} = \text{constant} \]</div>
<h3 id="keplers-third-law-the-law-of-periods">Kepler’s Third Law: The Law of Periods</h3>
<p>The square of the orbital period <span class="arithmatex">\( T \)</span> is proportional to the cube of the semi-major axis <span class="arithmatex">\( a \)</span> of the orbit:</p>
<div class="arithmatex">\[ T^2 = \frac{4 \pi^2 a^3}{G m_1} \]</div>
<p>Where:
- <span class="arithmatex">\( T \)</span> is the orbital period,
- <span class="arithmatex">\( a \)</span> is the semi-major axis of the orbit,
- <span class="arithmatex">\( m_1 \)</span> is the mass of the central body.</p>
<p>Using Kepler’s Third Law, we can classify possible trajectories into three types:</p>
<h3 id="1-elliptical-trajectory">1. Elliptical Trajectory</h3>
<p>An object follows a closed elliptical path, typical for most planets, moons, and satellites. The trajectory is bound.</p>
<h3 id="2-parabolic-trajectory">2. Parabolic Trajectory</h3>
<p>This is the case for an object that escapes a central body with exactly the escape velocity. The trajectory is unbound and follows a parabolic shape.</p>
<h3 id="3-hyperbolic-trajectory">3. Hyperbolic Trajectory</h3>
<p>An object that exceeds the escape velocity follows a hyperbolic trajectory, which is also unbound.</p>
<h2 id="3-defining-initial-conditions-and-their-impact-on-trajectory-types">3. Defining Initial Conditions and Their Impact on Trajectory Types</h2>
<p>The trajectory of an object depends on its initial conditions, such as position, velocity, and altitude.</p>
<ul>
<li><strong>Initial Position</strong>: The location in space relative to the central body.</li>
<li><strong>Initial Velocity</strong>: The speed and direction at which the object is moving when it is first released or launched.</li>
<li><strong>Altitude</strong>: The height above the central body’s surface, which influences the gravitational force and therefore the orbit.</li>
</ul>
<h3 id="impact-on-trajectory">Impact on Trajectory</h3>
<ul>
<li>If the initial velocity is less than the escape velocity, the object will follow an elliptical orbit.</li>
<li>If the initial velocity is equal to the escape velocity, the object will follow a parabolic trajectory.</li>
<li>If the initial velocity exceeds the escape velocity, the object will follow a hyperbolic trajectory.</li>
</ul>
<p>The escape velocity <span class="arithmatex">\( v_{\text{esc}} \)</span> is given by:</p>
<div class="arithmatex">\[ v_{\text{esc}} = \sqrt{\frac{2 G m_1}{r}} \]</div>
<p>Where <span class="arithmatex">\( r \)</span> is the initial distance from the center of the central body.</p>
<h2 id="4-analyzing-the-relationship-between-trajectories-and-orbital-insertion-reentry-or-escape-scenarios">4. Analyzing the Relationship Between Trajectories and Orbital Insertion, Reentry, or Escape Scenarios</h2>
<ul>
<li>
<p><strong>Orbital Insertion</strong>: When a spacecraft enters orbit around a central body, its velocity must be carefully controlled to ensure it follows a stable elliptical orbit. This is typically done by adjusting the spacecraft’s velocity via a maneuver known as a "burn".</p>
</li>
<li>
<p><strong>Reentry</strong>: For a spacecraft to reenter a planetary atmosphere, its trajectory must be adjusted so that it intersects the atmosphere at the correct angle and speed. A hyperbolic trajectory may result in a steep, high-speed reentry, which can be dangerous if not controlled.</p>
</li>
<li>
<p><strong>Escape</strong>: An object escapes the gravitational pull of the central body if it reaches or exceeds the escape velocity. This leads to a hyperbolic trajectory, and the object is no longer bound to the central body.</p>
</li>
</ul>
<p>The relationship between velocity and escape or reentry is crucial for mission planning, ensuring the correct orbital path for desired outcomes such as satellite deployment or interplanetary travel.</p>
<hr/>
<h1 id="numerical-analysis">Numerical Analysis</h1>
<p>In this section, we discuss the numerical methods used to solve the differential equations of motion for a payload under the influence of Earth’s gravitational field. The goal is to simulate the payload’s trajectory using a numerical approach and validate the results against known analytical expectations, such as a circular orbit.</p>
<h2 id="1-selecting-a-numerical-method">1. Selecting a Numerical Method</h2>
<p>To solve the equations of motion numerically, we will use the <strong>Runge-Kutta method</strong>, specifically the <strong>4th-order Runge-Kutta (RK4)</strong> method. This is a widely used method for solving ordinary differential equations (ODEs) because it offers a good balance between accuracy and computational efficiency.</p>
<p>The general form of the Runge-Kutta method for a first-order differential equation $ \frac{dy}{dt} = f(t, y) $ is:</p>
<div class="arithmatex">\[ y_{n+1} = y_n + \frac{h}{6} \left( k_1 + 2k_2 + 2k_3 + k_4 \right) \]</div>
<p>Where:
- $ h $ is the step size,
- $ k_1 = f(t_n, y_n) $,
- $ k_2 = f(t_n + \frac{h}{2}, y_n + \frac{h}{2} k_1) $,
- $ k_3 = f(t_n + \frac{h}{2}, y_n + \frac{h}{2} k_2) $,
- $ k_4 = f(t_n + h, y_n + h k_3) $.</p>
<p>Alternatively, the <strong>Euler method</strong> can be used as a simpler, though less accurate, numerical method:</p>
<div class="arithmatex">\[ y_{n+1} = y_n + h f(t_n, y_n) \]</div>
<p>While Euler’s method is easier to implement, it requires smaller step sizes for stability and is less accurate than Runge-Kutta, especially for more complex systems.</p>
<h2 id="2-setting-up-initial-conditions">2. Setting Up Initial Conditions</h2>
<p>The initial conditions for the payload’s trajectory must include the position vector, velocity vector, and altitude. We assume the payload is launched from a specific location near Earth’s surface.</p>
<p>Let the initial position vector $ \mathbf{r}_0 $ be:</p>
<div class="arithmatex">\[ \mathbf{r}_0 = \begin{bmatrix} r_{x0} \\ r_{y0} \\ r_{z0} \end{bmatrix} \]</div>
<p>Let the initial velocity vector $ \mathbf{v}_0 $ be:</p>
<div class="arithmatex">\[ \mathbf{v}_0 = \begin{bmatrix} v_{x0} \\ v_{y0} \\ v_{z0} \end{bmatrix} \]</div>
<p>The altitude $ h_0 $ can be calculated as the distance from the center of Earth:</p>
<div class="arithmatex">\[ h_0 = \sqrt{r_{x0}^2 + r_{y0}^2 + r_{z0}^2} - R_E \]</div>
<p>Where $ R_E $ is the radius of Earth.</p>
<p>The equations of motion under the influence of Earth's gravitational field are given by Newton’s second law:</p>
<div class="arithmatex">\[ \mathbf{F} = m \mathbf{a} = - \frac{G M_E m}{r^2} \hat{r} \]</div>
<p>Where:
- $ G $ is the gravitational constant,
- $ M_E $ is the mass of Earth,
- $ r $ is the magnitude of the position vector $ \mathbf{r} $,
- $ \hat{r} $ is the unit vector in the direction of $ \mathbf{r} $.</p>
<p>This force is used to update the velocity and position of the payload during each step of the numerical integration.</p>
<h2 id="3-computing-the-payloads-path">3. Computing the Payload's Path</h2>
<p>Using the initial conditions and the numerical method chosen (e.g., Runge-Kutta), we compute the trajectory of the payload over time. The numerical method will integrate the equations of motion iteratively.</p>
<p>The velocity and position at each time step are updated as follows:</p>
<div class="arithmatex">\[ \mathbf{r}_{n+1} = \mathbf{r}_n + h \mathbf{v}_n \]</div>
<div class="arithmatex">\[ \mathbf{v}_{n+1} = \mathbf{v}_n + h \frac{\mathbf{F}_n}{m} \]</div>
<p>Where:
- $ \mathbf{r}_n $ and $ \mathbf{v}_n $ are the position and velocity at the current time step,
- $ h $ is the step size,
- $ \mathbf{F}_n $ is the gravitational force at the current position.</p>
<p>We continue this process until we reach the desired time, at which point we will have a complete trajectory.</p>
<h2 id="4-validating-numerical-results">4. Validating Numerical Results</h2>
<p>After solving for the trajectory using the numerical method, we validate the results against known analytical expectations. For example, in the case of a <strong>circular orbit</strong>, the trajectory should maintain a constant radial distance from the center of Earth.</p>
<p>In a circular orbit, the orbital velocity is constant and is given by:</p>
<div class="arithmatex">\[ v_{\text{circular}} = \sqrt{\frac{G M_E}{r}} \]</div>
<p>Where:
- $ r $ is the orbital radius.</p>
<p>We can compare the computed velocity at each point along the trajectory with this theoretical velocity for a circular orbit.</p>
<p>For an <strong>elliptical orbit</strong>, we check if the computed trajectory satisfies Kepler’s Laws, especially the law of equal areas, which implies that the object should sweep out equal areas during equal time intervals.</p>
<p>In the case of more complex orbits or escape trajectories, we verify that the object’s velocity exceeds the escape velocity at the correct point, leading to a trajectory that no longer returns to Earth.</p>
<h3 id="example-circular-orbit-validation">Example: Circular Orbit Validation</h3>
<p>For a payload in a circular orbit at an altitude of 300 km above the Earth's surface, we expect the following conditions:
- The radius from the center of Earth is $ r = R_E + 300 \, \text{km} $,
- The orbital velocity should match the theoretical velocity:</p>
<div class="arithmatex">\[ v_{\text{orbital}} = \sqrt{\frac{G M_E}{R_E + 300}} \]</div>
<h2 id="by-comparing-the-computed-velocity-at-each-time-step-with-this-value-we-can-verify-the-accuracy-of-our-numerical-solution">By comparing the computed velocity at each time step with this value, we can verify the accuracy of our numerical solution.</h2>
<h2 id="code-and-plots">Code and Plots</h2>
<p><img alt="alt text" src="../image-3.png"/></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Constants
G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)
M_Earth = 5.972e24  # Mass of Earth (kg)
R_Earth = 6.371e6  # Radius of Earth (m)

# Earth's gravitational potential function
def acceleration(t, y):
    x, y, vx, vy = y
    r = np.sqrt(x**2 + y**2)
    if r &lt; R_Earth:  # Prevent orbits from going through Earth
        return [0, 0, 0, 0]
    a_x = -G * M_Earth * x / r**3
    a_y = -G * M_Earth * y / r**3
    return [vx, vy, a_x, a_y]

# Solve the equations of motion using solve_ivp
def simulate_orbit(y0, t_span, dt):
    sol = solve_ivp(acceleration, t_span, y0, dense_output=True, rtol=1e-9, atol=1e-12)
    t = np.arange(t_span[0], t_span[1], dt)
    y = sol.sol(t)

    # Filter out points inside the Earth
    x, y_vals = y[0, :], y[1, :]
    r = np.sqrt(x**2 + y_vals**2)
    mask = r &gt;= R_Earth
    x, y_vals = x[mask], y_vals[mask]

    return t[mask], np.array([x, y_vals])

# Plotting function
def plot_orbits(trajectories, earth_radius=R_Earth):
    fig, ax = plt.subplots(figsize=(8, 8))
    ax.set_aspect('equal')

    # Draw Earth
    circle = plt.Circle((0, 0), earth_radius, color='teal', alpha=0.4, label="Earth")
    ax.add_artist(circle)

    # Plot trajectories
    colors = ['darkorange', 'forestgreen', 'crimson', 'navy', 'gold']
    labels = [
        "Circular Orbit",
        "Elliptical Orbit",
        "Reentry Trajectory",
        "Escape Velocity",
        "Faster Than Circular"
    ]

    for i, traj in enumerate(trajectories):
        if traj[1] is not None:
            x, y = traj[1][0, :], traj[1][1, :]
            ax.plot(x, y, label=labels[i], color=colors[i], linewidth=1.5)

    # Add labels and legend
    ax.set_xlabel("x Position [m]")
    ax.set_ylabel("y Position [m]")
    ax.legend(loc='upper right')
    ax.grid(True, linestyle='--', alpha=0.5)
    plt.title("Satellite Trajectories Around Earth")
    plt.tight_layout()
    plt.show()

# Define initial conditions for multiple trajectories
trajectories = []

# Circular orbit
y0_circular = [R_Earth + 1e6, 0, 0, np.sqrt(G * M_Earth / (R_Earth + 1e6))]
trajectories.append(simulate_orbit(y0_circular, [0, 10000], 1))

# Elliptical orbit (slightly perturbed from circular)
y0_elliptical = [R_Earth + 1e6, 0, 0, np.sqrt(G * M_Earth / (R_Earth + 1e6)) * 0.9]
trajectories.append(simulate_orbit(y0_elliptical, [0, 12000], 1))

# Reentry trajectory (low velocity)
y0_reentry = [R_Earth + 1e6, 0, 0, np.sqrt(G * M_Earth / (R_Earth + 1e6)) * 0.5]
trajectories.append(simulate_orbit(y0_reentry, [0, 8000], 1))

# Escape trajectory (high velocity)
y0_escape = [R_Earth + 1e6, 0, 0, np.sqrt(G * M_Earth / (R_Earth + 1e6)) * 1.5]
trajectories.append(simulate_orbit(y0_escape, [0, 4000], 1))

# Faster than circular orbit
y0_faster_circular = [R_Earth + 1e6, 0, 0, np.sqrt(G * M_Earth / (R_Earth + 1e6)) * 1.1]
trajectories.append(simulate_orbit(y0_faster_circular, [0, 10000], 1))

# Plot all trajectories
plot_orbits(trajectories)
</code></pre>
<hr/>
<p><img alt="alt text" src="../image-2.png"/></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Constants
G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)
M_Earth = 5.972e24  # Mass of Earth (kg)
R_Earth = 6.371e6  # Radius of Earth (m)
Earth_radius_plot = 1.0  # Earth radius in plot units (normalized)

# Initial conditions
initial_height = 800e3  # 800 km above Earth's surface (m)
initial_position = np.array([R_Earth + initial_height, 0])  # Starting position (x, y)
initial_velocity_min = 10e3  # Minimum initial velocity (m/s)
initial_velocity_max = 20e3  # Maximum initial velocity (m/s)
velocity_step = 1e3  # Step size for velocity (m/s)

# Time span for simulation
t_span = (0, 10000)  # Simulation time in seconds

# Function to compute acceleration due to gravity
def acceleration(t, state):
    x, y, vx, vy = state
    r = np.sqrt(x**2 + y**2)  # Distance from Earth's center
    F = -G * M_Earth / r**3  # Gravitational force per unit mass
    ax = F * x
    ay = F * y
    return [vx, vy, ax, ay]

# Solve ODE for each initial velocity
trajectories = []
for v0 in np.arange(initial_velocity_min, initial_velocity_max + velocity_step, velocity_step):
    # Initial state: [x, y, vx, vy]
    initial_state = [*initial_position, 0, v0]  # Zero horizontal velocity
    solution = solve_ivp(acceleration, t_span, initial_state, atol=1e-9, rtol=1e-9)
    trajectories.append(solution.y[:2])  # Store only x and y positions

# Plot the results
plt.figure(figsize=(8, 8))
plt.title("Trajectories in a Gravitational Field with Filled Earth")
plt.xlabel("x [Earth radii]")
plt.ylabel("y [Earth radii]")

# Plot Earth
circle = plt.Circle((0, 0), Earth_radius_plot, color='blue', alpha=0.5, label="Earth")
plt.gca().add_patch(circle)

# Plot trajectories
colors = plt.cm.viridis(np.linspace(0, 1, len(trajectories)))
for i, traj in enumerate(trajectories):
    x, y = traj
    plt.plot(x / R_Earth, y / R_Earth, color=colors[i], label=f"v₀ = {initial_velocity_min + i * velocity_step / 1e3:.1f} km/s")

plt.legend()
plt.axis('equal')
plt.grid(True)
plt.show()
</code></pre>
<hr/>
<p><img alt="alt text" src="../image-4.png"/></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Constants
G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)
M_Earth = 5.972e24  # Mass of Earth (kg)
R_Earth = 6.371e6  # Radius of Earth (m)

# Acceleration due to Earth's gravity
def acceleration(t, y):
    x, y, vx, vy = y
    r = np.hypot(x, y)  # Faster than sqrt(x**2 + y**2)
    if r &lt; R_Earth:  # Prevent going inside Earth
        return [0, 0, 0, 0]
    a = -G * M_Earth / r**3
    return [vx, vy, a * x, a * y]

# Simulate orbit given initial conditions
def simulate_orbit(y0, t_span, dt):
    sol = solve_ivp(acceleration, t_span, y0, dense_output=True, rtol=1e-9, atol=1e-12)
    t = np.arange(*t_span, dt)
    x, y = sol.sol(t)[0], sol.sol(t)[1]
    r = np.hypot(x, y)
    mask = r &gt;= R_Earth
    return x[mask], y[mask]

# Plot multiple trajectories
def plot_trajectories(initial_conditions_list, t_max=100000, num_points=20000):
    fig, ax = plt.subplots(figsize=(8, 8))
    ax.set_aspect('equal')

    # Draw Earth
    earth_circle = plt.Circle((0, 0), R_Earth, color='teal', alpha=0.5, label="Earth")
    ax.add_artist(earth_circle)

    colors = plt.cm.plasma(np.linspace(0, 1, len(initial_conditions_list)))

    dt = t_max / num_points
    for i, (x0, y0, vx0, vy0) in enumerate(initial_conditions_list):
        x_traj, y_traj = simulate_orbit([x0, y0, vx0, vy0], [0, t_max], dt)
        ax.plot(x_traj, y_traj, color=colors[i], linewidth=1.2, label=f"v = {vy0:.0f} m/s")

    # Axis settings
    ax.set_xlabel("x Position [m]")
    ax.set_ylabel("y Position [m]")
    ax.legend(loc='upper right', title="Initial Velocity", fontsize='small')
    ax.grid(True, linestyle='--', alpha=0.5)
    plt.title("Satellite Trajectories Around Earth (Varying Initial Velocity)")
    plt.tight_layout()
    plt.show()

# Define initial conditions
initial_conditions_list = [
    (R_Earth + 1e6, 0, 0, 9000),
    (R_Earth + 1e6, 0, 0, 9100),
    (R_Earth + 1e6, 0, 0, 9200),
    (R_Earth + 1e6, 0, 0, 9300),
    (R_Earth + 1e6, 0, 0, 9400),
    (R_Earth + 1e6, 0, 0, 9500),
    (R_Earth + 1e6, 0, 0, 9600),
    (R_Earth + 1e6, 0, 0, 9700),
    (R_Earth + 1e6, 0, 0, 9800),
    (R_Earth + 1e6, 0, 0, 9900),
    (R_Earth + 1e6, 0, 0, 10000),
]

# Run simulation and plot
plot_trajectories(initial_conditions_list, t_max=100000, num_points=20000)
</code></pre>
<h2 id="colab">Colab</h2>
<p><a href="https://colab.research.google.com/drive/1wx9GhiBFtkUn58U_VoO2hIqG4AyF5Of4">Colab</a></p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../Problem_2/" title="Problem 2"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../3%20Waves/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../Problem_2/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
